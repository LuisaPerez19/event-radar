<div class="container">
  <div class="split-container">
    <div class="column">

      <div class="left-pane">
        <h1><%= @event.name %></h1>

        <div class="event-image-info">
          <div class="event-image">
              <% if @event.photos.attached? %>
              <% @event.photos.each do |photo| %>
              <%= cl_image_tag photo.key, height: 400, width: 600, crop: :fill %>
              <% end %>
            <% end %>
          </div>

          <div class="info">
            <div class="location">
              <span> <i class="fa-solid fa-location-dot"></i> <%= @event.location %></span>
            </div>
            <div class="date">
              <span > <i class="fa-solid fa-calendar-days"></i> <%= @event.start_date.strftime("%d/%m/%y - %T") %></span>
            </div>
          </div>
        </div>

        <div class="event-details">
          <h2>Event Details</h2>
          <p> <%= @event.description %></p>
        </div>
      </div>


      <div class="right-pane">
        <div class="right-pane-align">
            <%# <div class="booking-form" style="border: 1px solid #ccc; padding: 45px; border-radius: 20px; margin-top: 20px;"> %>
              <div class="tickets">
                <%# <h2>Billing info</h2> %>
                <div class="elem-group inlined">
                  <label for="ticket_count">Tickets</label>
                  <input type="number" id="ticket_count" name="total_tickets" placeholder="1" min="1" value="1" >
                </div>

                <div class="elem-group inlined">
                  <label for="price_per_ticket">Price per Ticket</label>
                  <input type="number" id="price_per_ticket" name="price_per_ticket" placeholder="<%= @event.price %>" min="0" value="<%= @event.price %>" readonly>
                </div>
              </div>

              <div class="elem-group-total">
                <div>
                  <label for="total_price">Total</label>
                </div>
                <div>
                  <p id="total_price">Total Price: Â£<span id="display_total_price"><%= @event.price %></span></p>
                </div>
              </div>




              <div>
                  <br>
                  <a href="<%= new_event_booking_path(@event) %>">
                  <button type="button" class="btn btn-primary" style="background-color: #C069EC; width: 424px; box-shadow: 5px 5px 20px rgba(150, 150, 150, 0.5);">Book Now</button>
                </a>
              </div>
            <%# </div> %>

              <div class="map">
                <% if @event.photos.attached? %>
                  <% @event.photos.each do |photo| %>
                  <% end %>
                <% end %>

                  <div
                    data-controller="map"
                    data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"
                    data-map-marker-value="<%= @marker.to_json %>"
                    style="width: 400px; height: 200px; border-radius: 20px; overflow: hidden; margin-top: 20px;"
                    ></div>
              </div>

              <script>
                const calculate = (pricePerTicket, ticketCount) => {
                  if (isNaN(pricePerTicket) || isNaN(ticketCount)) {
                    return total;
                  }

                  var total = pricePerTicket * ticketCount;
                  updateTotalPrice(total);
                }
                function calculateTotalPrice(e){
                  var pricePerTicket = parseFloat(document.getElementById("price_per_ticket").value)
                  var ticketCountElement = e.target;
                  var ticketCount = parseFloat(ticketCountElement.value)
                  calculate(pricePerTicket, ticketCount)
                }

                function updateTotalPrice(total) {
                  document.getElementById("display_total_price").textContent = total.toFixed(2);
                }
                document.addEventListener("DOMContentLoaded", function() {
                  var ticketCountElement = document.getElementById("ticket_count");
                  ticketCountElement.addEventListener("change", (e) => calculateTotalPrice(e));
                });
              </script>
        </div>
      <div>
    </div>
  </div>
</div>


<%# <div style="clear: both; margin-bottom: 20px;"></div> <!-- Add space between the photos and Event Details -->


<h2 style="margin-left: -100px; margin-top: 20px; color: white;"><strong>Event Details</strong></h2>
<p style="margin-left: -100px; color: white;"> %>
